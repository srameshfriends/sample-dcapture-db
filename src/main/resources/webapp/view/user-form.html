<div class="container">
    <div id="user-form-div" class="row">
        <div class="mx-auto manage-max">
            <div class="card">
                <div class="card-header">
                    <span id="actionBack">
                        <i class="fas fa-arrow-left icon-blue"></i>
                    </span>
                    <span data-locale="userInformation" class="ml-3"></span>
                    <span class="float-right" id="actionClose">
                        <i class="fas fa-times icon-blue"></i>
                    </span>
                </div>
                <div class="card-body">
                    <form data-id="apps_user" data-type="form" class="form" role="form" method="post">
                        <input type="hidden" data-id="apps_user.id" data-type="hidden">
                        <input type="hidden" data-id="apps_user.rev" data-type="hidden">
                        <div class="form-group">
                            <label data-locale="apps_user.name" class="form-control-label"></label>
                            <input data-id="apps_user.name" data-type="text" class="form-control">
                        </div>
                        <div class="form-group">
                            <button id="actionSave" data-locale="actionSave" class="btn btn-outline-primary"></button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
<script>
    function UserFormView() {
        let self = this;
        self.getId = function () {
            return "user-form";
        };
        self.model = {name: "apps_user"};
        self.onSave = function (data) {
            $.ajax({
                type: "POST",
                dataType: "json",
                url: "api/user/save",
                data: JSON.stringify(data),
                error: function (err) {
                    MessageDialog.show(err.responseText);
                },
                success: function () {
                    PageManager.show("view/user-list.html");
                }
            });
        };
        self.form = new FormBinder(self.model);
        $("#actionSave").on("click", function (evt) {
            evt.preventDefault();
            self.onSave([self.form.getValue()]);
        });
        $("#actionClose").on("click", function (evt) {
            evt.preventDefault();
            PageManager.show("view/user-list.html");
        });
        $("#actionBack").on("click", function (evt) {
            evt.preventDefault();
            PageManager.showPrevious();
        });
        self.start = function () {
            self.form.setValue(SessionDB.get("apps_user"));
        };
    }
    if(typeof PageManager === "undefined") {
        window.location.href = "../index.html";
    } else {
        PageManager.init(new UserFormView());
    }
</script>
